(block gpg_agent
	(typeattribute subj_type_attribute)

	(blockinherit app.application_cmd_obj_blk)

	(call subj_entry (subj_type_attribute cmd_file))

	(blockinherit file.config_obj_blk)

	(blockinherit usersubj.home_user_obj_blk)

	(call manage_home_user (subj_type_attribute))
	(call gpg_home_user_obj_type_transition_home (subj_type_attribute))

	(allow subj_type_attribute self create_unix_stream_stream_socket_perms)
	(allow subj_type_attribute self (unix_stream_socket (connectto)))
	(allow subj_type_attribute self rw_fifo_file_perms)

	(call sys_read_crypto_sysctl_files (subj_type_attribute))

	(call dev_read_random (subj_type_attribute))
	(call dev_read_urandom (subj_type_attribute))

	(call file.read_data_files (subj_type_attribute))

	(call fs_list_devtmpfs (subj_type_attribute))
	(call fs_search_tmpfs (subj_type_attribute))

	(call gpg.manage_home_user_dirs (subj_type_attribute))
	(call gpg.home_dir_obj_type_transition_home (subj_type_attribute))

	(call locale.read (subj_type_attribute))

	(call usersubj.use_term (subj_type_attribute))

	(optional gpg_agent_subj_type_optional_tor
		(call tor.read_config_files (subj_type_attribute)))

	(optional gpg_agent_subj_type_optional_scdaemon
		(call scdaemon.stream_connect (subj_type_attribute))))
