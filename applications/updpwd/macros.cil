(macro updpwd_exec ((type ARG1))
	(call can_exec (ARG1 updpwd.cmd_file)))

(macro updpwd_auto_subj_type_transition ((type ARG1))
	(call updpwd_send_signal (ARG1))
	(call auto_subj_type_transition_pattern (ARG1 updpwd.cmd_file updpwd.subj)))

(macro updpwd_send_signal ((type ARG1))
	(allow ARG1 updpwd.subj (process (signal))))

(macro updpwd_run ((type ARG1)(role ARG2))
	(call updpwd_auto_subj_type_transition (ARG1))
	(roleattributeset updpwd_role (ARG2)))
