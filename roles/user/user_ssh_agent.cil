;;;;;;;;;;;;;;;;;;;;;;;;;;
;
; Policy
;

(block user_ssh_agent
	(blockinherit ssh_agent.subj_blk)

	(call user.cmd_auto_subj_type_transition (subj))
	(call user.shell_auto_subj_type_transition (subj))

	(call user.home_cmd_auto_subj_type_transition (subj))

	(optional user_ssh_agent_optional_user_gpg_agent
		(call user_gpg_agent.stream_connect (subj)))

	(optional user_ssh_agent_optional_user_gs
		(call user_gs.send_sigchld (subj))
		(call user_gs.auto_subj_type_transition_gs_helper (subj)))

	(optional user_ssh_agent_optional_user_xsession
		(call user.xclients_home_user_auto_type_transition_subj_type
			(subj))))
